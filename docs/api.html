
<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GoatCounter API documentation 0.1</title>

	<style>
		body {
			font: 16px/1.9em sans-serif;
			background-color: #eee;
		}

		a {
			text-decoration: none;
		}

		p, ul {
			margin: 0;
			padding: 0;
		}

		ul {
			margin-left: 2em;
		}

		h3 {
			font-size: 1.5em;
			position: relative;
			margin-top: 1rem;
			margin-bottom: 0;
			padding: .2rem;
			padding-left: .5rem;
			margin-bottom: -1px;
		}

		h3.js-expand {
			cursor: pointer;
		}

		h4 {
			margin: 0;
			font-size: 16px;
		}

		sup {
			color: #aaa;
		}

		.permalink {
			font-weight: normal;
			color: rgb(0, 0, 238);

			 
			width: 1.5em;
			display: inline-block;
			text-align: center;
		}

		.permalink:visited {
			color: rgb(0, 0, 238);
		}

		.permalink:hover {
			color: #66f;
		}

		h3 .permalink {
			font-size: 16px;
		}

		.endpoint {
			position: relative;
			background-color: #fff;
			border: 1px solid #b7b7b7;
			margin-bottom: -1px;
			padding: .2em .5em;
			border-radius: 2px;
		}

		.endpoint-top {
			cursor: pointer;
		}

		.endpoint-info {
			margin-left: 4.5rem;
			display: none;
		}

		.endpoint-info p {
			max-width: 55em;
		}

		.model p {
			margin-left: 2em;
			white-space: pre-line;
		}

		.resource {
			display: inline-block;
			min-width: 38rem;
		}

		.resource .method {
			display: inline-block;
			min-width: 4rem;
		}

		.param-name {
			display: inline-block;
			min-width: 11rem;
		}
	</style>
</head>

<body>
	<h1>GoatCounter API documentation 0.1</h1>

	

	

	<h2>Endpoints</h2>
	
		
			</div><div>
			<h3 id="count" class="js-expand">count
				<a class="permalink" href="#count">§</a></h3>

		<div class="endpoint" id="POST-/api/v0/count">
			<div class="endpoint-top">
				<code class="resource"><span class="method">POST</span> /api/v0/count</code>
				Count pageviews.
				<a class="permalink" href="#POST-%2fapi%2fv0%2fcount">§</a>
			</div>

			<div class="endpoint-info">
				<p>This can count one or more pageviews. Pageviews are not persisted immediatly,
but persisted in the background every 10 seconds.

The maximum amount of pageviews per request is 100.

Errors will have the key set to the index of the pageview. Any pageviews not
listed have been processed and shouldn&#39;t be sent again.</p>
					<h4>Request body</h4>
					<ul>
						<li><a href="#handlers.apiCountRequest">handlers.apiCountRequest</a>
							<sup>(application/json)</sup></li>
					</ul>

				<h4>Responses</h4>
				<ul>
					<li><code class="param-name">202 Accepted</code>
								202 Accepted (no data)
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">400 Bad Request</code>
								<a href="#handlers.apiError">handlers.apiError</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">403 Forbidden</code>
								<a href="#handlers.authError">handlers.authError</a>
							<sup>(application/json)</sup>
					</li></ul>
			</div>
		</div>
	
		
			</div><div>
			<h3 id="export" class="js-expand">export
				<a class="permalink" href="#export">§</a></h3>

		<div class="endpoint" id="GET-/api/v0/export/{id}">
			<div class="endpoint-top">
				<code class="resource"><span class="method">GET</span> /api/v0/export/{id}</code>
				Get details about an export.
				<a class="permalink" href="#GET-%2fapi%2fv0%2fexport%2f%7bid%7d">§</a>
			</div>

			<div class="endpoint-info">
				<p></p>

				<h4>Responses</h4>
				<ul>
					<li><code class="param-name">200 OK</code>
								<a href="#goatcounter.Export">goatcounter.Export</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">400 Bad Request</code>
								<a href="#handlers.apiError">handlers.apiError</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">403 Forbidden</code>
								<a href="#handlers.authError">handlers.authError</a>
							<sup>(application/json)</sup>
					</li></ul>
			</div>
		</div>
	
		

		<div class="endpoint" id="GET-/api/v0/export/{id}/download">
			<div class="endpoint-top">
				<code class="resource"><span class="method">GET</span> /api/v0/export/{id}/download</code>
				Download an export file.
				<a class="permalink" href="#GET-%2fapi%2fv0%2fexport%2f%7bid%7d%2fdownload">§</a>
			</div>

			<div class="endpoint-info">
				<p></p>

				<h4>Responses</h4>
				<ul>
					<li><code class="param-name">200 OK</code>
								200 OK (text/csv data)
							<sup>(text/csv)</sup>
					</li>
					<li><code class="param-name">400 Bad Request</code>
								<a href="#handlers.apiError">handlers.apiError</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">403 Forbidden</code>
								<a href="#handlers.authError">handlers.authError</a>
							<sup>(application/json)</sup>
					</li></ul>
			</div>
		</div>
	
		

		<div class="endpoint" id="POST-/api/v0/export">
			<div class="endpoint-top">
				<code class="resource"><span class="method">POST</span> /api/v0/export</code>
				Start a new export in the background.
				<a class="permalink" href="#POST-%2fapi%2fv0%2fexport">§</a>
			</div>

			<div class="endpoint-info">
				<p>This starts a new export in the background.</p>
					<h4>Request body</h4>
					<ul>
						<li><a href="#handlers.apiExportRequest">handlers.apiExportRequest</a>
							<sup>(application/json)</sup></li>
					</ul>

				<h4>Responses</h4>
				<ul>
					<li><code class="param-name">202 Accepted</code>
								<a href="#goatcounter.Export">goatcounter.Export</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">400 Bad Request</code>
								<a href="#handlers.apiError">handlers.apiError</a>
							<sup>(application/json)</sup>
					</li>
					<li><code class="param-name">403 Forbidden</code>
								<a href="#handlers.authError">handlers.authError</a>
							<sup>(application/json)</sup>
					</li></ul>
			</div>
		</div>
	

	<h2>Models</h2>
	
		<h3 id="goatcounter.Export">goatcounter.Export <a class="permalink" href="#goatcounter.Export">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>id <sup>integer [readonly]</sup></h4>
<p></p>
<h4>site_id <sup>integer [readonly]</sup></h4>
<p></p>
<h4>start_from_hit_id <sup>integer</sup></h4>
<p>The hit ID this export was started from.</p>
<h4>last_hit_id <sup>integer [readonly]</sup></h4>
<p>Last hit ID that was exported; can be used as start_from_hit_id.</p>
<h4>created_at <sup>string [format: date-time] [readonly]</sup></h4>
<p></p>
<h4>finished_at <sup>string [format: date-time] [readonly]</sup></h4>
<p></p>
<h4>num_rows <sup>integer [readonly]</sup></h4>
<p></p>
<h4>size <sup>string [readonly]</sup></h4>
<p>File size in MB.</p>
<h4>hash <sup>string [readonly]</sup></h4>
<p>SHA256 hash.</p>
<h4>error <sup>string [readonly]</sup></h4>
<p>Any errors that may have occured.</p>

		</div>
		<h3 id="handlers.apiCountRequest">handlers.apiCountRequest <a class="permalink" href="#handlers.apiCountRequest">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>no_sessions <sup>boolean</sup></h4>
<p>Don&#39;t try to count unique visitors; every pageview will be considered a
&#34;visit&#34;.</p>
<h4>hits <sup>array [type: <a href="#handlers.apiCountRequestHit">handlers.apiCountRequestHit</a>]</sup></h4>
<p></p>

		</div>
		<h3 id="handlers.apiCountRequestHit">handlers.apiCountRequestHit <a class="permalink" href="#handlers.apiCountRequestHit">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>path <sup>string [required]</sup></h4>
<p>Path of the pageview, or the event name.</p>
<h4>title <sup>string</sup></h4>
<p>Page title, or some descriptive event title.</p>
<h4>event <sup>boolean</sup></h4>
<p>Is this an event?</p>
<h4>ref <sup>string</sup></h4>
<p>Referrer value, can be an URL (i.e. the Referal: header) or any
string.</p>
<h4>size <sup>array [type: number]</sup></h4>
<p>Screen size as &#34;x,y,scaling&#34;</p>
<h4>query <sup>string</sup></h4>
<p>Query parameters for this pageview, used to get campaign parameters.</p>
<h4>bot <sup>integer</sup></h4>
<p>Hint if this should be considered a bot; should be one of the JSBot*`
constants from isbot; note the backend may override this if it
detects a bot using another method.
https://github.com/zgoat/isbot/blob/master/isbot.go#L28</p>
<h4>browser <sup>string</sup></h4>
<p>User-Agent header.</p>
<h4>location <sup>string</sup></h4>
<p>Location as ISO-3166-1 alpha2 string (e.g. NL, ID, etc.)</p>
<h4>ip <sup>string</sup></h4>
<p>IP to get location from; not used if location is set. Also used for
session generation.</p>
<h4>created_at <sup>string [format: date-time]</sup></h4>
<p>Time this pageview should be recorded at; this can be in the past,
but not in the future.</p>
<h4>session <sup>string</sup></h4>
<p>Normally a session is based on hash(User-Agent+IP+salt), but if you don&#39;t
send the IP address then we can&#39;t determine the session.

In those cases, you can store your own session identifiers and send them
along. Note these will not be stored in the database as the sessionID
(just as the hashes aren&#39;t), they&#39;re just used as a unique grouping
identifier.

You can also just disable sessions entirely with NoSessions.</p>

		</div>
		<h3 id="handlers.apiError">handlers.apiError <a class="permalink" href="#handlers.apiError">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>Error <sup>string</sup></h4>
<p></p>
<h4>Errors <sup><a href="#"></a></sup></h4>
<p></p>

		</div>
		<h3 id="handlers.apiExportRequest">handlers.apiExportRequest <a class="permalink" href="#handlers.apiExportRequest">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>start_from_hit_id <sup>integer</sup></h4>
<p>Pagination cursor; only export hits with an ID greater than this.</p>

		</div>
		<h3 id="handlers.authError">handlers.authError <a class="permalink" href="#handlers.authError">§</a></h3>
		<div class="endpoint model">
			<p class="info"></p>
			<h4>Error <sup>string</sup></h4>
<p></p>

		</div>

	<script>
		var add = function(endpoint) {
			
			var topLine = endpoint.getElementsByClassName('endpoint-top')[0]
			var info = endpoint.getElementsByClassName('endpoint-info')[0]
			topLine.addEventListener('click', function(e) {
				if (e.target.className === 'permalink')
					return

				e.preventDefault()
				
				info.style.display = info.style.display === 'block' ? '' : 'block'
			})

			
			
			
			
			
		}

		var ep = document.getElementsByClassName('endpoint')
		for (var i = 0; i < ep.length; i++)
			add(ep[i])

		
		document.addEventListener('click', function(e) {
			if (e.target.className !== 'js-expand')
				return

			e.preventDefault()
			var parent = e.target.parentNode
			if (parent.tagName.toLowerCase() === 'h3')
				parent = parent.parentNode

			var info = parent.getElementsByClassName('info')
			for (var i = 0; i < info.length; i++)
				info[i].style.display = info[i].style.display === 'block' ? '' : 'block'
		})
	</script>
</body>
</html>
